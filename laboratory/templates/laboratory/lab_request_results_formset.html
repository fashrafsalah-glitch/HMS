{% extends "base.html" %}
{% block content %}
<div class="container py-3">
  <h3>Enter Results – Request #{{ request_obj.id }} ({{ patient }})</h3>

  <form method="post">{% csrf_token %}
    {{ formset.management_form }}
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>Test</th>
            <th style="width:18%">Numeric</th>
            <th style="width:18%">Text</th>
            <th style="width:12%">Unit</th>
            <th style="width:16%">Ref (min–max)</th>
            <th style="width:14%">Status</th>
            <th style="width:8%">Delete</th>
          </tr>
        </thead>
        <tbody>
          {% for f in formset.forms %}
            <tr>
              <td>{{ f.test }}</td>
              <td>{{ f.value_num }}</td>
              <td>{{ f.observed_value }}</td>
              <td>{{ f.unit }}</td>
              <td class="d-flex gap-1">{{ f.ref_min }} {{ f.ref_max }}</td>
              <td>{{ f.status }}</td>
              <td>{{ f.DELETE }}</td>
            </tr>
            <tr>
              <td colspan="7">{{ f.notes }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="d-flex gap-2">
      <button class="btn btn-primary">Save Results</button>
      <a class="btn btn-secondary" href="{% url 'laboratory:lab_request_detail' request_obj.id %}">Back</a>
    </div>
  </form>
</div>
{% endblock %}